var inputFocused=!1;var rowsProcessed=0;var rowsToProcess=0;var inputFieldNames=[];var outputFieldSpecs=[];var maxTransformParams=10;var allTransforms=['[None]','[String] Upper Case','[String] Lower Case','[String] Title Case','[String] Sentence Case','[String] Reverse','[String] Pad to Length','[String] Trim','[String] Remove','[String] Replace','[String] Substring','[String] Split Part','[String] Concatenate','[Number] Convert Format','[Number] Add','[Number] Subtract','[Number] Multiply','[Number] Divide','[Number] Exponent','[Number] Modulus','[Date] Convert Format','[Date] Add Days','[Date] Subtract Days',];var numberTransformOperation={'[Number] Add':'+','[Number] Subtract':'-','[Number] Multiply':'*','[Number] Divide':'/','[Number] Exponent':'^','[Number] Modulus':'%',};var monthToNum={'JAN':'01','JANUARY':'01','FEB':'02','FEBRUARY':'02','MAR':'03','MARCH':'03','APR':'04','APRIL':'04','MAY':'05','JUN':'06','JUNE':'06','JUL':'07','JULY':'07','AUG':'08','AUGUST':'08','SEP':'09','SEPTEMBER':'09','OCT':'10','OCTOBER':'10','NOV':'11','NOVEMBER':'11','DEC':'12','DECEMBER':'12',};var numToMon={'01':'JAN','02':'FEB','03':'MAR','04':'APR','05':'MAY','06':'JUN','07':'JUL','08':'AUG','09':'SEP','10':'OCT','11':'NOV','12':'DEC',};var numToMonth={'01':'JANUARY','02':'FEBRUARY','03':'MARCH','04':'APRIL','05':'MAY','06':'JUNE','07':'JULY','08':'AUGUST','09':'SEPTEMBER','10':'OCTOBER','11':'NOVEMBER','12':'DECEMBER',};var allDateFormats=['YYYYMMDD','MMDDYYYY','DDMMYYYY','YYMMDD','MMDDYY','DDMMYY','YYYY-MM-DD','YY-MM-DD','MM-DD-YYYY','MM-DD-YY','DD-MM-YYYY','DD-MM-YY','YYYY MM DD','YY MM DD','MM DD YYYY','MM DD YY','DD MM YYYY','DD MM YY','MM/DD/YYYY','MM/DD/YY','DD/MM/YYYY','DD/MM/YY','MON D YYYY','MON D YY','MON D, YYYY','MON D, YY','MONTH D YYYY','MONTH D YY','MONTH D, YYYY','MONTH D, YY','DD-MON-YYYY','DD-MON-YY',];function sleep(ms){return new Promise(resolve=>setTimeout(resolve,ms))}
function escapeRegExp(str){return str.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}
function strReplace(str,trimLeadingTrailing,strToReplace,strToInsert,caseInsensitive,consecutiveAsOne){var modifiers=caseInsensitive;var regExpStr=escapeRegExp(strToReplace);if(trimLeadingTrailing==='l'){regExpStr='^(?:'+regExpStr+')+'}
else if(trimLeadingTrailing==='t'){regExpStr='(?:'+regExpStr+')+$'}
else{if(consecutiveAsOne){regExpStr='(?:'+regExpStr+')+'}
modifiers+='g'}
var regExp=new RegExp(regExpStr,modifiers);return str.replace(regExp,strToInsert)}
function strToCharArray(str){var charArray=[];for(var i=0;i<str.length;i++){if(i+1<str.length){var value=str.charCodeAt(i);var nextValue=str.charCodeAt(i+1);if((value>=0xD800&&value<=0xDBFF&&(nextValue&0xFC00)==0xDC00)||(nextValue>=0x0300&&nextValue<=0x036F)){charArray.push(str.substring(i,i+2));i++;continue}}
charArray.push(str[i])}
return charArray}
function strToNum(str){str=str.replace(/[^0-9\.\-\(\)\e\E]/g,'');if(/^\(/.test(str)&&/\)$/.test(str)){str='-'+str}
str=str.replace(/[\(\)]/g,'');if(isNaN(str)){str=str.replace(/e/gi,'')}
if(str===''||str==='-'){str2='0'}
return+str}
function roundNumtoStr(num,precision,commas){var shift=function(num,precision){var numArray=(''+num.toString()).split('e');return+(numArray[0]+'e'+(numArray[1]?(+numArray[1]+precision):precision))};var numRounded=shift(Math.round(shift(num,+precision)),-precision).toString();var integer='';var decimal='';if(precision>0){if(!/\./.test(numRounded)){integer=numRounded}else{var parts=numRounded.split('.');integer=parts[0];decimal=parts[1]}
decimal=stringPadToLength(decimal,'a','0',precision);numRounded=integer+'.'+decimal}
if(commas){var parts=numRounded.split('.');return parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,',')+(parts[1]?'.'+parts[1]:'')}else{return numRounded}}
function readInDateStr(str,inputFormat){var year='';var month='';var day='';if(inputFormat==='YYYYMMDD'){year=str.substring(0,4)||'';month=str.substring(4,6)||'';day=str.substring(6,8)||''}else if(inputFormat==='MMDDYYYY'){year=str.substring(4,8)||'';month=str.substring(0,2)||'';day=str.substring(2,4)||''}else if(inputFormat==='DDMMYYYY'){year=str.substring(4,8)||'';month=str.substring(2,4)||'';day=str.substring(0,2)||''}else if(inputFormat==='YYMMDD'){year=str.substring(0,2)||'';month=str.substring(2,4)||'';day=str.substring(4,6)||''}else if(inputFormat==='MMDDYY'){year=str.substring(4,6)||'';month=str.substring(0,2)||'';day=str.substring(2,4)||''}else if(inputFormat==='DDMMYY'){year=str.substring(4,6)||'';month=str.substring(2,4)||'';day=str.substring(0,2)||''}else if(inputFormat==='YYYY-MM-DD'||inputFormat==='YY-MM-DD'){var parts=str.split('-');year=parts[0]||'';month=parts[1]||'';day=parts[2]||''}else if(inputFormat==='MM-DD-YYYY'||inputFormat==='MM-DD-YY'){var parts=str.split('-');year=parts[2]||'';month=parts[0]||'';day=parts[1]||''}else if(inputFormat==='DD-MM-YYYY'||inputFormat==='DD-MM-YY'){var parts=str.split('-');year=parts[2]||'';month=parts[1]||'';day=parts[0]||''}else if(inputFormat==='YYYY MM DD'||inputFormat==='YY MM DD'){var parts=str.split(' ');year=parts[0]||'';month=parts[1]||'';day=parts[2]||''}else if(inputFormat==='MM DD YYYY'||inputFormat==='MM DD YY'){var parts=str.split(' ');year=parts[2]||'';month=parts[0]||'';day=parts[1]||''}else if(inputFormat==='DD MM YYYY'||inputFormat==='DD MM YY'){var parts=str.split(' ');year=parts[2]||'';month=parts[1]||'';day=parts[0]||''}else if(inputFormat==='MM/DD/YYYY'||inputFormat==='MM/DD/YY'){var parts=str.split('/');year=parts[2]||'';month=parts[0]||'';day=parts[1]||''}else if(inputFormat==='DD/MM/YYYY'||inputFormat==='DD/MM/YY'){var parts=str.split('/');year=parts[2]||'';month=parts[1]||'';day=parts[0]||''}else if(inputFormat==='MON D YYYY'||inputFormat==='MON D YY'||inputFormat==='MON D, YYYY'||inputFormat==='MON D, YY'||inputFormat==='MONTH D YYYY'||inputFormat==='MONTH D YY'||inputFormat==='MONTH D, YYYY'||inputFormat==='MONTH D, YY'){var parts=str.split(' ');year=parts[2]||'';var mon=(parts[0]||'').toUpperCase();month=monthToNum[mon]||'';day=(parts[1]||'').replace(/[^0-9]/g,'')}else if(inputFormat==='DD-MON-YYYY'||inputFormat==='DD-MON-YY'){var parts=str.split('-');year=parts[2]||'';var mon=(parts[1]||'').toUpperCase();month=monthToNum[mon]||'';day=parts[0]||''}else{}
var parsableDateString=month+'/'+day+'/'+year;var dateAsNum=Date.parse(parsableDateString);if(isNaN(dateAsNum)){return'NaD'}else{return dateAsNum.toString()}}
function twoDig(num){var str=num.toString();if(str.length>=2){return str}else if(str.length===1){return'0'+str}else{return'01'}}
function fieldTransform(inputValue,transformIndex,params,allInputValues){var outputValue='';var transform=allTransforms[transformIndex];if(transform==='[String] Upper Case'){outputValue=stringUpperCase(inputValue)}else if(transform==='[String] Lower Case'){outputValue=stringLowerCase(inputValue)}else if(transform==='[String] Title Case'){outputValue=stringTitleCase(inputValue)}else if(transform==='[String] Sentence Case'){outputValue=stringSentenceCase(inputValue)}else if(transform==='[String] Reverse'){outputValue=stringReverse(inputValue)}else if(transform==='[String] Pad to Length'){var padBeforeOrAfter=params[0];var padChar=params[1];var desiredLength=params[2];outputValue=stringPadToLength(inputValue,padBeforeOrAfter,padChar,desiredLength)}else if(transform==='[String] Trim'){var sideToTrim=params[0];var strToTrimSelect=params[1];var strToTrimOther=params[2];var caseInsensitive=params[3];outputValue=stringTrim(inputValue,sideToTrim,strToTrimSelect,strToTrimOther,caseInsensitive)}else if(transform==='[String] Remove'){var strToRemoveSelect=params[0];var strToRemoveOther=params[1];var caseInsensitive=params[2];outputValue=stringRemove(inputValue,strToRemoveSelect,strToRemoveOther,caseInsensitive)}else if(transform==='[String] Replace'){var strToReplaceSelect=params[0];var strToReplaceOther=params[1];var strToInsert=params[2];var caseInsensitive=params[3];var consecutiveAsOne=!1;if(params[4]==='1'){consecutiveAsOne=!0}
outputValue=stringReplace(inputValue,strToReplaceSelect,strToReplaceOther,strToInsert,caseInsensitive,consecutiveAsOne)}else if(transform==='[String] Substring'){var start=0;var length=0;if(params[1]===''){length=inputValue.length}else{length=+params[1]}
if(/^\-?\d+$/gi.test(params[0])){start=+params[0];outputValue=stringSubstring(inputValue,start,length)}else{outputValue=''}}else if(transform==='[String] Split Part'){var delim=params[0];var partNumber=0;if(/^\-?\d+$/gi.test(params[1])){partNumber=+params[1];outputValue=stringSplitPart(inputValue,delim,partNumber)}else{outputValue=''}}else if(transform==='[String] Concatenate'){var inputFieldSelect=params[0];var inputFixedValue=params[1];var str2;if(inputFieldSelect==='0'){str2=inputFixedValue}else{str2=allInputValues[inputFieldSelect]}
outputValue=inputValue+str2}else if(transform==='[Number] Convert Format'){var format=params[0];var inclCommas=params[1];var commas=!1;if(inclCommas==='1'){commas=!0}
var decPlaces=params[2];var precision=+decPlaces;outputValue=numberConvertFormat(inputValue,format,commas,precision)}else if(transform in numberTransformOperation){var operation=numberTransformOperation[transform];var inputFieldSelect=params[0];var inputFixedValue=params[1];var str2;if(inputFieldSelect==='0'){str2=inputFixedValue}else{str2=allInputValues[inputFieldSelect]}
outputValue=numberOperation(inputValue,str2,operation)}else if(transform==='[Date] Convert Format'){var inputFormat=params[0];var outputFormat=params[1];outputValue=dateConvertFormat(inputValue,inputFormat,outputFormat,0)}else if(transform==='[Date] Add Days'){var inputFormat=params[0];var outputFormat=params[1];var addDays=params[2];outputValue=dateConvertFormat(inputValue,inputFormat,outputFormat,+addDays)}else if(transform==='[Date] Subtract Days'){var inputFormat=params[0];var outputFormat=params[1];var subtractDays=params[2];outputValue=dateConvertFormat(inputValue,inputFormat,outputFormat,-subtractDays)}else{outputValue=inputValue}
return outputValue}
function stringUpperCase(str){var charArray=strToCharArray(str);var strUpper='';for(var i=0;i<charArray.length;i++){strUpper+=charArray[i].toUpperCase()}
return strUpper}
function stringLowerCase(str){var charArray=strToCharArray(str);var strLower='';for(var i=0;i<charArray.length;i++){strLower+=charArray[i].toLowerCase()}
return strLower}
function stringTitleCase(str){var strTitle='';var caps=!0;var charArray=strToCharArray(str);for(var i=0;i<charArray.length;i++){var char=charArray[i];if(caps){strTitle+=stringUpperCase(char)}else{strTitle+=stringLowerCase(char)}
if(/\S/.test(char)){caps=!1}else{caps=!0}}
return strTitle}
function stringSentenceCase(str){var strSentence='';var caps=!0;var charArray=strToCharArray(str);for(var i=0;i<charArray.length;i++){var char=charArray[i];if(caps){strSentence+=stringUpperCase(char)}else{strSentence+=stringLowerCase(char)}
if(/[\.\?\!]/.test(char)){caps=!0}else if(/\S/.test(char)){caps=!1}else{}}
return strSentence}
function stringReverse(str){var charArray=strToCharArray(str);var strReverse='';for(var i=charArray.length-1;i>=0;i--){strReverse+=charArray[i]}
return strReverse}
function stringPadToLength(str,padBeforeOrAfter,padChar,desiredLength){var currentLength=str.length;if(desiredLength<=currentLength){return str}
var padding=new Array(desiredLength-currentLength+1).join(padChar);if(padBeforeOrAfter==='b'){return padding+str}
else{return str+padding}}
function stringTrim(str,sideToTrim,strToTrimSelect,strToTrimOther,caseInsensitive){if(str===''||strToTrimSelect===''){return str}
if(strToTrimSelect==='WHITESPACE'){if(sideToTrim==='l'){return str.replace(/^\s+/,'')}else if(sideToTrim==='t'){return str.replace(/\s+$/,'')}else{return str.replace(/^\s+|\s+$/g,'')}}else if(strToTrimSelect==='TAB'){if(sideToTrim==='l'){return str.replace(/^\t+/,'')}else if(sideToTrim==='t'){return str.replace(/\t+$/,'')}else{return str.replace(/^\t+|\t+$/g,'')}}else{if(strToTrimOther===''){return str}else{if(sideToTrim==='l'){return strReplace(str,'l',strToTrimOther,'',caseInsensitive,!1)}else if(sideToTrim==='t'){return strReplace(str,'t',strToTrimOther,'',caseInsensitive,!1)}else{str=strReplace(str,'l',strToTrimOther,'',caseInsensitive,!1);return strReplace(str,'t',strToTrimOther,'',caseInsensitive,!1)}}}}
function stringRemove(str,strToRemoveSelect,strToRemoveOther,caseInsensitive){if(str===''||strToRemoveSelect===''){return str}
if(strToRemoveSelect==='WHITESPACE'){return str.replace(/\s+/g,'')}else if(strToRemoveSelect==='TAB'){return str.replace(/\t+/g,'')}else{if(strToRemoveOther===''){return str}else{return strReplace(str,'',strToRemoveOther,'',caseInsensitive,!0)}}}
function stringReplace(str,strToReplaceSelect,strToReplaceOther,strToInsert,caseInsensitive,consecutiveAsOne){if(str===''||strToReplaceSelect===''){return str}
if(strToReplaceSelect==='WHITESPACE'){if(consecutiveAsOne){return str.replace(/\s+/g,strToInsert)}else{return str.replace(/\s/g,strToInsert)}}else if(strToReplaceSelect==='TAB'){if(consecutiveAsOne){return str.replace(/\t+/g,strToInsert)}else{return str.replace(/\t/g,strToInsert)}}else{if(strToReplaceOther===''){return str}else{return strReplace(str,'',strToReplaceOther,strToInsert,caseInsensitive,consecutiveAsOne)}}}
function stringSubstring(str,start,length){if(start>0){start=start-1}
var chars=strToCharArray(str);var numChars=chars.length;if(start<0){start=Math.max(0,(numChars+start))}else{start=Math.min(numChars,start)}
var end=Math.min(numChars,(start+length));return chars.slice(start,end).join('')}
function stringSplitPart(str,delim,partNumber){var parts=str.split(delim);if(partNumber===0){return parts[0]}else if(partNumber>0){partNumber=partNumber-1}else if(partNumber<0){partNumber=parts.length+partNumber}
if((partNumber<0)||(partNumber>=parts.length)){return''}else{return parts[partNumber]}}
function numberConvertFormat(str,format,commas,precision){var num=strToNum(str);if(format==='INT'){return roundNumtoStr(num,0,commas)}else if(format==='DEC'){return roundNumtoStr(num,precision,commas)}else if(format==='SCI'){return num.toExponential().toString()}else if(format==='CUR'){var currency='$'+roundNumtoStr(num,2,!0);return currency.replace(/^\$\-/,'-$')}else if(format==='ACC'){var accounting=roundNumtoStr(num,2,!0);accounting=accounting.replace(/^\-(.+)$/,"($1)");if(accounting==='0.00'){return'-'}else{return'$'+accounting}}else{return num.toString()}}
function numberOperation(str,str2,operation){var num=strToNum(str);var num2=strToNum(str2);if(operation==='+'){return num+num2}else if(operation==='-'){return num-num2}else if(operation==='*'){return num*num2}else if(operation==='/'){return num/num2}else if(operation==='^'){return Math.pow(num,num2)}else if(operation==='%'){return num%num2}else{return num}}
function dateConvertFormat(str,inputFormat,outputFormat,addDays){var addToEpoch=addDays*86400000;var dateAsNumStr=readInDateStr(str,inputFormat);var year='';var yearTwoDig='';var month='';var day='';var dayOneDig='';if(dateAsNumStr==='NaD'){return dateAsNumStr}else{var dateAsNum=+dateAsNumStr;var date=new Date(dateAsNum+addToEpoch);year=date.getFullYear().toString();yearTwoDig=year.substring(2,4);month=twoDig(date.getMonth()+1);day=twoDig(date.getDate());dayOneDig=date.getDate().toString()}
var outputStr='';if(outputFormat==='YYYYMMDD'){outputStr=year+month+day}else if(outputFormat==='MMDDYYYY'){outputStr=month+day+year}else if(outputFormat==='DDMMYYYY'){outputStr=day+month+year}else if(outputFormat==='YYMMDD'){outputStr=yearTwoDig+month+day}else if(outputFormat==='MMDDYY'){outputStr=month+day+yearTwoDig}else if(outputFormat==='DDMMYY'){outputStr=day+month+yearTwoDig}else if(outputFormat==='YYYY-MM-DD'){outputStr=year+'-'+month+'-'+day}else if(outputFormat==='YY-MM-DD'){outputStr=yearTwoDig+'-'+month+'-'+day}else if(outputFormat==='MM-DD-YYYY'){outputStr=month+'-'+day+'-'+year}else if(outputFormat==='MM-DD-YY'){outputStr=month+'-'+day+'-'+yearTwoDig}else if(outputFormat==='DD-MM-YYYY'){outputStr=day+'-'+month+'-'+year}else if(outputFormat==='DD-MM-YY'){outputStr=day+'-'+month+'-'+yearTwoDig}else if(outputFormat==='YYYY MM DD'){outputStr=year+' '+month+' '+day}else if(outputFormat==='YY MM DD'){outputStr=yearTwoDig+' '+month+' '+day}else if(outputFormat==='MM DD YYYY'){outputStr=month+' '+day+' '+year}else if(outputFormat==='MM DD YY'){outputStr=month+' '+day+' '+yearTwoDig}else if(outputFormat==='DD MM YYYY'){outputStr=day+' '+month+' '+year}else if(outputFormat==='DD MM YY'){outputStr=day+' '+month+' '+yearTwoDig}else if(outputFormat==='MM/DD/YYYY'){outputStr=month+'/'+day+'/'+year}else if(outputFormat==='MM/DD/YY'){outputStr=month+'/'+day+'/'+yearTwoDig}else if(outputFormat==='DD/MM/YYYY'){outputStr=day+'/'+month+'/'+year}else if(outputFormat==='DD/MM/YY'){outputStr=day+'/'+month+'/'+yearTwoDig}else if(outputFormat==='MON D YYYY'){outputStr=numToMon[month]+' '+dayOneDig+' '+year}else if(outputFormat==='MON D YY'){outputStr=numToMon[month]+' '+dayOneDig+' '+yearTwoDig}else if(outputFormat==='MON D, YYYY'){outputStr=numToMon[month]+' '+dayOneDig+', '+year}else if(outputFormat==='MON D, YY'){outputStr=numToMon[month]+' '+dayOneDig+', '+yearTwoDig}else if(outputFormat==='MONTH D YYYY'){outputStr=numToMonth[month]+' '+dayOneDig+' '+year}else if(outputFormat==='MONTH D YY'){outputStr=numToMonth[month]+' '+dayOneDig+' '+yearTwoDig}else if(outputFormat==='MONTH D, YYYY'){outputStr=numToMonth[month]+' '+dayOneDig+', '+year}else if(outputFormat==='MONTH D, YY'){outputStr=numToMonth[month]+' '+dayOneDig+', '+yearTwoDig}else if(outputFormat==='DD-MON-YYYY'){outputStr=day+'-'+numToMon[month]+'-'+year}else if(outputFormat==='DD-MON-YY'){outputStr=day+'-'+numToMon[month]+'-'+yearTwoDig}else{}
return outputStr}
function copyText(id){document.getElementById(id).select();document.execCommand('Copy')}
function clearExampleText(){if(!inputFocused){document.getElementById('input').innerHTML='';inputFocused=!0}}
function delimIsOther(type){var id=type+'_delimiter_select';if(document.getElementById(id).value==='OTHER'){return!0}else{return!1}}
function setCustomDelimDisplay(type){var id='custom_'+type+'_delimiter';if(delimIsOther(type)){document.getElementById(id).style.display='inline'}else{document.getElementById(id).style.display='none'}}
function isDoubleQuoted(type){var id=type+'_quoted';if(document.getElementById(id).value==='1'){return!0}else{return!1}}
function calcDelim(type){var delim='';var quoted=isDoubleQuoted(type);var selectId=type+'_delimiter_select';var otherId=type+'_delimiter_other';if(delimIsOther(type)){delim=document.getElementById(otherId).value;if(quoted){delim='"'+delim+'"'}}else{var selectedDelim=document.getElementById(selectId).value;if(selectedDelim==='WHITESPACE'){if(quoted){delim=/"\s+"/}else{delim=/\s+/}}else{if(selectedDelim==='COMMA'){delim=','}else if(selectedDelim==='PIPE'){delim='|'}else if(selectedDelim==='COLON'){delim=':'}else if(selectedDelim==='TAB'){delim="\t"}else if(selectedDelim==='SPACE'){delim=' '}
if(quoted){delim='"'+delim+'"'}}}
return delim}
function includesHeader(type){var id=type+'_header';if(document.getElementById(id).value==='1'){return!0}else{return!1}}
function generateInputPreviewTable(){var lines=document.getElementById('input').value.split(/\r?\n/).slice(0,10);var totalFields=0;var innerHTML='';var previewHeaderWritten=!1;for(var i=0;i<lines.length;i++){var fields=lines[i].split(calcDelim('input'));var j=0;if(isDoubleQuoted('input')){fields[0]=fields[0].replace(/^"/,'');var lastIndex=fields.length-1;if(lastIndex>0){fields[lastIndex]=fields[lastIndex].replace(/"$/,'')}}
if(previewHeaderWritten){if(lines[i]===''){continue}
innerHTML+='<tr>';for(j=0;j<fields.length;j++){innerHTML+='<td>'+fields[j]+'</td>'}
innerHTML+='</tr>'}else{totalFields=fields.length;innerHTML+='<tr>';for(j=0;j<totalFields;j++){var fieldNum=j+1;innerHTML+='<th>'+'FIELD '+fieldNum+'</th>'}
innerHTML+='</tr>';if(includesHeader('input')){innerHTML+='<tr>';for(j=0;j<totalFields;j++){innerHTML+='<th>';innerHTML+=fields[j];innerHTML+='</th>'}
innerHTML+='</tr>';inputFieldNames=fields}else{innerHTML+='<tr>';for(j=0;j<totalFields;j++){innerHTML+='<td>'+fields[j]+'</td>';inputFieldNames[j]=''}
innerHTML+='</tr>'}
previewHeaderWritten=!0}}
innerHTML+='<tr><td id="last_preview_row" colspan="'+totalFields+'">...</td></tr>';document.getElementById('input_preview').innerHTML=innerHTML}
function updateOutputFieldSpecs(){for(var i=0;i<outputFieldSpecs.length;i++){outputFieldSpecs[i].name=document.getElementById('output_field_name_'+i).value;outputFieldSpecs[i].input=document.getElementById('output_field_input_'+i).value;outputFieldSpecs[i].transform=document.getElementById('output_field_transform_'+i).value;outputFieldSpecs[i].fixed_val=document.getElementById('fixed_val_'+i).value;for(var j=0;j<maxTransformParams;j++){var id='transform_param'+(j+1)+'_'+i;if(document.getElementById(id)){outputFieldSpecs[i].transform_params[j]=document.getElementById(id).value}}}}
function appendTransformParameters(html,i){var t=allTransforms[outputFieldSpecs[i].transform];var p=outputFieldSpecs[i].transform_params;if(t==='[String] Pad to Length'){html+='Side to Pad: <select class="transform_params" id="transform_param1_'+i+'" onchange="outputRefresh();">';html+='<option value="b"';if(p[0]==='b'){html+=' selected'}
html+='>Pad Before</option>';html+='<option value="a"';if(p[0]==='a'){html+=' selected'}
html+='>Pad After</option>';html+='</select><br>';html+='Pad Character: <input class="transform_params_short allow_tabs" type="text" id="transform_param2_'+i+'" onchange="outputRefresh();" maxlength="1"><br>';html+='Total Length: <input class="transform_params last_param only_digits" type="text" id="transform_param3_'+i+'" onchange="outputRefresh();">'}
else if(t==='[String] Trim'){html+='Side(s) to Trim: <select class="transform_params" id="transform_param1_'+i+'" onchange="outputRefresh();">';html+='<option value="l"';if(p[0]==='l'){html+=' selected'}
html+='>Trim Leading</option>';html+='<option value="t"';if(p[0]==='t'){html+=' selected'}
html+='>Trim Trailing</option>';html+='<option value="b"';if(p[0]==='b'){html+=' selected'}
html+='>Trim Both</option>';html+='</select><br>';html+='Trim: <select class="transform_params" id="transform_param2_'+i+'" onchange="outputRefresh();">';html+='<option value="WHITESPACE"';if(p[1]==='WHITESPACE'){html+=' selected'}
html+='>White Space</option>';html+='<option value="TAB"';if(p[1]==='TAB'){html+=' selected'}
html+='>Tab</option>';html+='<option value="OTHER"';if(p[1]==='OTHER'){html+=' selected'}
html+='>[Other]</option>';html+='</select>';html+='<input class="transform_params allow_tabs"';if(p[1]!=='OTHER'){html+=' style="display: none;" '}
html+='type="text" id="transform_param3_'+i+'" onchange="outputRefresh();"><br>';html+='<div';if(p[1]!=='OTHER'){html+=' style="display: none;"'}
html+='>Case Sensitivity: <select class="transform_params last_param" id="transform_param4_'+i+'" onchange="outputRefresh();">';html+='<option value=""';if(p[3]===''){html+=' selected'}
html+='>Case Sensitive</option>';html+='<option value="i"';if(p[3]==='i'){html+=' selected'}
html+='>Ignore Case</option>';html+='</select></div>'}
else if(t==='[String] Remove'){html+='Text to Remove: <select class="transform_params" id="transform_param1_'+i+'" onchange="outputRefresh();">';html+='<option value="WHITESPACE"';if(p[0]==='WHITESPACE'){html+=' selected'}
html+='>White Space</option>';html+='<option value="TAB"';if(p[0]==='TAB'){html+=' selected'}
html+='>Tab</option>';html+='<option value="OTHER"';if(p[0]==='OTHER'){html+=' selected'}
html+='>[Other]</option>';html+='</select>';html+='<input class="transform_params allow_tabs"';if(p[0]!=='OTHER'){html+=' style="display: none;"'}
html+=' type="text" id="transform_param2_'+i+'" onchange="outputRefresh();"><br>';html+='<div';if(p[0]!=='OTHER'){html+=' style="display: none;"'}
html+='>Case Sensitivity: <select class="transform_params last_param" id="transform_param3_'+i+'" onchange="outputRefresh();">';html+='<option value=""';if(p[2]===''){html+=' selected'}
html+='>Case Sensitive</option>';html+='<option value="i"';if(p[2]==='i'){html+=' selected'}
html+='>Ignore Case</option>';html+='</select></div>'}
else if(t==='[String] Replace'){html+='Text to Replace: <select class="transform_params" id="transform_param1_'+i+'" onchange="outputRefresh();">';html+='<option value="WHITESPACE"';if(p[0]==='WHITESPACE'){html+=' selected'}
html+='>White Space</option>';html+='<option value="TAB"';if(p[0]==='TAB'){html+=' selected'}
html+='>Tab</option>';html+='<option value="OTHER"';if(p[0]==='OTHER'){html+=' selected'}
html+='>[Other]</option>';html+='</select>';html+='<input class="transform_params allow_tabs"';if(p[0]!=='OTHER'){html+=' style="display: none;"'}
html+=' type="text" id="transform_param2_'+i+'" onchange="outputRefresh();"><br>';html+='Text to Insert: <input class="transform_params allow_tabs" type="text" id="transform_param3_'+i+'" onchange="outputRefresh();"><br>';html+='<div';if(p[0]!=='OTHER'){html+=' style="display: none;"'}
html+='>Case Sensitivity: <select class="transform_params" id="transform_param4_'+i+'" onchange="outputRefresh();">';html+='<option value=""';if(p[3]===''){html+=' selected'}
html+='>Case Sensitive</option>';html+='<option value="i"';if(p[3]==='i'){html+=' selected'}
html+='>Ignore Case</option>';html+='</select></div>';html+='Treat Consecutive as One*: <select class="transform_params" id="transform_param5_'+i+'" onchange="outputRefresh();">';html+='<option value="0"';if(p[4]==='0'){html+=' selected'}
html+='>No</option>';html+='<option value="1"';if(p[4]==='1'){html+=' selected'}
html+='>Yes</option>';html+='</select><br>';html+='<div class="note last_param">* If selected, consecutive instances of the replace text will be treated as one, and will be replaced with one instance of the insert text, as opposed to each being replaced individually.</div>'}
else if(t==='[String] Substring'){html+='<div class="note last_param">Note: You could enter 1 as the Starting Position to start from the beginning of the string, 2 to start at the second character, etc. But you could also enter -1 to start at the last character, -2 to start at the second to last character, etc.</div>';html+='<div class="note last_param">Note 2: Leave the length blank to go till the end of the string.</div>';html+='Starting Position: <input class="transform_params only_dash_digits" type="text" id="transform_param1_'+i+'" onchange="outputRefresh();"><br>';html+='Substring Length: <input class="transform_params last_param only_digits" type="text" id="transform_param2_'+i+'" onchange="outputRefresh();">'}
else if(t==='[String] Split Part'){html+='<div class="note last_param">Note: You could enter 1 to get the first part, 2 to get the second part, etc. But you could also enter -1 to get the last part, -2 to get the second to last part, etc.</div>';html+='Split On: <input class="transform_params allow_tabs" type="text" id="transform_param1_'+i+'" onchange="outputRefresh();"><br>';html+='Part Number: <input class="transform_params last_param only_dash_digits" type="text" id="transform_param2_'+i+'" onchange="outputRefresh();">'}
else if(t==='[String] Concatenate'){var j=0;html+='Concatenate: <select ';if(p[0]==0){html+='class="transform_params" '}else{html+='class="transform_params_long" '}
html+='id="transform_param1_'+i+'" onchange="outputRefresh();">';if(p[0]==0){html+='<option value="0" selected>[Fixed Value]</option>'}else{html+='<option value="0">[Fixed Value]</option>'}
for(j=1;j<=inputFieldNames.length;j++){html+='<option value="'+j+'"';if(j==p[0]){html+=' selected'}
html+='>Input Field '+j;var realIndex=j-1;if(inputFieldNames[realIndex]!=''){html+=' ('+inputFieldNames[realIndex]+')'}
html+='</option>'}
if(!outputFieldSpecs[i].hide){var hiddenCount=0;for(j=0;j<outputFieldSpecs.length;j++){if(outputFieldSpecs[j].hide){hiddenCount++;html+='<option value="'+(hiddenCount*-1)+'"';if((hiddenCount*-1)==p[0]){html+=' selected'}
html+='>Hidden Field '+hiddenCount;if(outputFieldSpecs[j].name!=''){html+=' ('+outputFieldSpecs[j].name+')'}
html+='</option>'}}}
html+='</select>';html+='<input type="text" class="transform_params last_param allow_tabs" ';if(p[0]!=0){html+='style="display: none;" '}
html+='id="transform_param2_'+i+'">'}
else if(t==='[Number] Convert Format'){html+='Format: <select class="transform_params" id="transform_param1_'+i+'" onchange="outputRefresh();">';html+='<option value="INT"';if(p[0]==='INT'){html+=' selected'}
html+='>Integer</option>';html+='<option value="DEC"';if(p[0]==='DEC'){html+=' selected'}
html+='>Decimal</option>';html+='<option value="SCI"';if(p[0]==='SCI'){html+=' selected'}
html+='>Scientific</option>';html+='<option value="CUR"';if(p[0]==='CUR'){html+=' selected'}
html+='>Currency</option>';html+='<option value="ACC"';if(p[0]==='ACC'){html+=' selected'}
html+='>Accounting</option>';html+='</select>';html+='<div';if(p[0]!==''&&p[0]!=='INT'&&p[0]!=='DEC'){html+=' style="display: none;"'}
html+='>Include Commas: <select class="transform_params" id="transform_param2_'+i+'" onchange="outputRefresh();">';html+='<option value="0"';if(p[1]==='0'){html+=' selected'}
html+='>No</option>';html+='<option value="1"';if(p[1]==='1'){html+=' selected'}
html+='>Yes</option>';html+='</select></div>';html+='<div';if(p[0]!=='DEC'){html+=' style="display: none;"'}
html+='>Decimal Places: <input class="transform_params_short last_param only_digits" type="text" id="transform_param3_'+i+'" onchange="outputRefresh();" maxlength="3"></div>'}
else if(t in numberTransformOperation){var j=0;var op=numberTransformOperation[t];if(op==='+'){html+='Add: '}else if(op==='-'){html+='Subtract: '}else if(op==='*'){html+='Multiply By: '}else if(op==='/'){html+='Divide By: '}else if(op==='^'){html+='To The Power Of: '}else if(op==='%'){html+='Modulus: '}
html+='<select ';if(p[0]==0){html+='class="transform_params" '}else{html+='class="transform_params_long" '}
html+='id="transform_param1_'+i+'" onchange="outputRefresh();">';if(p[0]==0){html+='<option value="0" selected>[Fixed Value]</option>'}else{html+='<option value="0">[Fixed Value]</option>'}
for(j=1;j<=inputFieldNames.length;j++){html+='<option value="'+j+'"';if(j==p[0]){html+=' selected'}
html+='>Input Field '+j;var realIndex=j-1;if(inputFieldNames[realIndex]!=''){html+=' ('+inputFieldNames[realIndex]+')'}
html+='</option>'}
if(!outputFieldSpecs[i].hide){var hiddenCount=0;for(j=0;j<outputFieldSpecs.length;j++){if(outputFieldSpecs[j].hide){hiddenCount++;html+='<option value="'+(hiddenCount*-1)+'"';if((hiddenCount*-1)==p[0]){html+=' selected'}
html+='>Hidden Field '+hiddenCount;if(outputFieldSpecs[j].name!=''){html+=' ('+outputFieldSpecs[j].name+')'}
html+='</option>'}}}
html+='</select>';html+='<input type="text" class="transform_params last_param" ';if(p[0]!=0){html+='style="display: none;" '}
html+='id="transform_param2_'+i+'">'}
else if(t==='[Date] Convert Format'){var j=0;html+='Input Format: <select class="transform_params" id="transform_param1_'+i+'" onchange="outputRefresh();">';for(j=0;j<allDateFormats.length;j++){html+='<option value="'+allDateFormats[j]+'"';if(p[0]===allDateFormats[j]){html+=' selected'}
html+='>'+allDateFormats[j]+'</option>'}
html+='</select><br>';html+='Output Format: <select class="transform_params last_param" id="transform_param2_'+i+'" onchange="outputRefresh();">';for(j=0;j<allDateFormats.length;j++){html+='<option value="'+allDateFormats[j]+'"';if(p[1]===allDateFormats[j]){html+=' selected'}
html+='>'+allDateFormats[j]+'</option>'}
html+='</select>'}
else if(t==='[Date] Add Days'){var j=0;html+='Input Format: <select class="transform_params" id="transform_param1_'+i+'" onchange="outputRefresh();">';for(j=0;j<allDateFormats.length;j++){html+='<option value="'+allDateFormats[j]+'"';if(p[0]===allDateFormats[j]){html+=' selected'}
html+='>'+allDateFormats[j]+'</option>'}
html+='</select><br>';html+='Output Format: <select class="transform_params" id="transform_param2_'+i+'" onchange="outputRefresh();">';for(j=0;j<allDateFormats.length;j++){html+='<option value="'+allDateFormats[j]+'"';if(p[1]===allDateFormats[j]){html+=' selected'}
html+='>'+allDateFormats[j]+'</option>'}
html+='</select><br>';html+='Add Days: <input class="transform_params last_param only_digits" type="text" id="transform_param3_'+i+'" onchange="outputRefresh();">'}
else if(t==='[Date] Subtract Days'){var j=0;html+='Input Format: <select class="transform_params" id="transform_param1_'+i+'" onchange="outputRefresh();">';for(j=0;j<allDateFormats.length;j++){html+='<option value="'+allDateFormats[j]+'"';if(p[0]===allDateFormats[j]){html+=' selected'}
html+='>'+allDateFormats[j]+'</option>'}
html+='</select><br>';html+='Output Format: <select class="transform_params" id="transform_param2_'+i+'" onchange="outputRefresh();">';for(j=0;j<allDateFormats.length;j++){html+='<option value="'+allDateFormats[j]+'"';if(p[1]===allDateFormats[j]){html+=' selected'}
html+='>'+allDateFormats[j]+'</option>'}
html+='</select><br>';html+='Subtract Days: <input class="transform_params last_param only_digits" type="text" id="transform_param3_'+i+'" onchange="outputRefresh();">'}
return html}
function generateOutputFieldSpecsTable(){var i=0;var innerHTML='<tr><th class="field_no_td">OUTPUT FIELD NO.</th><th>OUTPUT FIELD NAME</th><th>INPUT FIELD</th><th>TRANSFORM</th></tr>';var numNonHiddenFields=0;var numHiddenFields=0;for(i=0;i<outputFieldSpecs.length;i++){var j=0;var num='<table class="field_no"><tr>';if(outputFieldSpecs[i].hide){numHiddenFields++;num+='<td>H'+numHiddenFields+'</td>'}else{numNonHiddenFields++;num+='<td>'+numNonHiddenFields+'</td>'}
num+='<td>';if(i!==0){num+='<span class="updown_arrows" onclick="moveOutputField(\'left\', '+i+');">&#9650;</span>'}
num+='</td>';num+='<td>';if(i!==(outputFieldSpecs.length-1)){num+='<span class="updown_arrows" onclick="moveOutputField(\'right\', '+i+');">&#9660;</span>'}
num+='</td>';num+='<td><span class="delete_button" onclick="deleteOutputField('+i+');">&#10005;</span></td>';num+='</tr></table>';var name='<input type="text" id="output_field_name_'+i+'" onchange="outputRefresh();">';var input='<select id="output_field_input_'+i+'" onchange="outputRefresh();">';if(outputFieldSpecs[i].input==='0'){input+='<option value="0" selected>[Fixed Value]</option>'}else{input+='<option value="0">[Fixed Value]</option>'}
for(j=1;j<=inputFieldNames.length;j++){input+='<option value="'+j+'"';if(j==outputFieldSpecs[i].input){input+=' selected'}
input+='>Input Field '+j;var realIndex=j-1;if(inputFieldNames[realIndex]!=''){input+=' ('+inputFieldNames[realIndex]+')'}
input+='</option>'}
if(!outputFieldSpecs[i].hide){var hiddenCount=0;for(j=0;j<outputFieldSpecs.length;j++){if(outputFieldSpecs[j].hide){hiddenCount++;input+='<option value="'+(hiddenCount*-1)+'"';if((hiddenCount*-1)==outputFieldSpecs[i].input){input+=' selected'}
input+='>Hidden Field '+hiddenCount;if(outputFieldSpecs[j].name!=''){input+=' ('+outputFieldSpecs[j].name+')'}
input+='</option>'}}}
input+='</select><br>';input+='<input type="text" class="last_param"';if(outputFieldSpecs[i].input!=0){input+=' style="display: none;"'}
input+=' id="fixed_val_'+i+'">';var transform='<select id="output_field_transform_'+i+'" onchange="transformSelectionChange('+i+')">';for(j=0;j<allTransforms.length;j++){transform+='<option value="'+j+'"';if(j==outputFieldSpecs[i].transform){transform+=' selected'}
transform+='>'+allTransforms[j];transform+='</option>'}
transform+='</select>';transform=appendTransformParameters(transform,i);if(outputFieldSpecs[i].hide){innerHTML+='<tr class="hidden_field">'}else{innerHTML+='<tr>'}
innerHTML+='<td class="field_no_td">'+num+'</td><td>'+name+'</td><td>'+input+'</td><td>'+transform+'</td></tr>'}
document.getElementById("output_field_specs").innerHTML=innerHTML;for(i=0;i<outputFieldSpecs.length;i++){document.getElementById('output_field_name_'+i).value=outputFieldSpecs[i].name;document.getElementById('fixed_val_'+i).value=outputFieldSpecs[i].fixed_val;for(var j=0;j<maxTransformParams;j++){var id='transform_param'+(j+1)+'_'+i;if(document.getElementById(id)){if(document.getElementById(id).tagName.toUpperCase()==='INPUT'){document.getElementById(id).value=outputFieldSpecs[i].transform_params[j]}}}}
var allowTabInputs=document.getElementsByClassName('allow_tabs');for(i=0;i<allowTabInputs.length;i++){allowTabInputs[i].onkeydown=allowTabs}
var onlyDigitInputs=document.getElementsByClassName('only_digits');for(i=0;i<onlyDigitInputs.length;i++){onlyDigitInputs[i].onkeypress=onlyAllowDigits;onlyDigitInputs[i].onpaste=onlyAllowDigits}
var onlyDashDigitInputs=document.getElementsByClassName('only_dash_digits');for(i=0;i<onlyDashDigitInputs.length;i++){onlyDashDigitInputs[i].onkeypress=onlyAllowDashDigits;onlyDashDigitInputs[i].onpaste=onlyAllowDashDigits}}
function addOutputField(hide){updateOutputFieldSpecs();var transformArray=[];for(var i=0;i<maxTransformParams;i++){transformArray.push('')}
outputFieldSpecs.push({'num':(outputFieldSpecs.length+1),'name':'','hide':hide,'input':1,'fixed_val':'','transform':'','transform_params':transformArray});generateOutputFieldSpecsTable()}
function deleteOutputField(index){updateOutputFieldSpecs();var updatedArray=[];for(var i=0;i<outputFieldSpecs.length;i++){if(i!==index){updatedArray.push(outputFieldSpecs[i])}}
outputFieldSpecs=updatedArray;generateOutputFieldSpecsTable()}
function calcHiddenFields(){var hiddenFields={};var hiddenCount=0;for(var i=0;i<outputFieldSpecs.length;i++){if(outputFieldSpecs[i].hide){hiddenCount++;hiddenFields[i]=hiddenCount*-1}}
return hiddenFields}
function moveOutputField(direction,index){updateOutputFieldSpecs();var otherIndex=0;if(direction==='left'){otherIndex=index-1}else{otherIndex=index+1}
var otherField=outputFieldSpecs[otherIndex];outputFieldSpecs[otherIndex]=outputFieldSpecs[index];outputFieldSpecs[index]=otherField;if((outputFieldSpecs[otherIndex].hide)&&(outputFieldSpecs[index].hide)){var hiddenFields=calcHiddenFields();for(var i=0;i<outputFieldSpecs.length;i++){if(outputFieldSpecs[i].input==hiddenFields[index]){outputFieldSpecs[i].input=hiddenFields[otherIndex]}else if(outputFieldSpecs[i].input==hiddenFields[otherIndex]){outputFieldSpecs[i].input=hiddenFields[index]}
var t=allTransforms[outputFieldSpecs[i].transform];if(t in numberTransformOperation||t==='[String] Concatenate'){var existingIndex=outputFieldSpecs[i].transform_params[0];if(existingIndex<0){if(existingIndex==hiddenFields[index]){outputFieldSpecs[i].transform_params[0]=hiddenFields[otherIndex]}else if(existingIndex==hiddenFields[otherIndex]){outputFieldSpecs[i].transform_params[0]=hiddenFields[index]}}}}}
generateOutputFieldSpecsTable()}
function outputRefresh(){updateOutputFieldSpecs();generateOutputFieldSpecsTable()}
function transformSelectionChange(index){updateOutputFieldSpecs();outputFieldSpecs[index].transform_params=[];for(var i=0;i<maxTransformParams;i++){outputFieldSpecs[index].transform_params.push('')}
generateOutputFieldSpecsTable()}
function assembleOutputLine(fieldValues,delim,quoted,eol){var line=fieldValues.join(delim);if(quoted){line='"'+line+'"'}
if(eol==='crlf'){line+="\r"}
line+="\n";return line}
function showProcessRunning(){document.getElementById('run_button').innerHTML='Processing... ';if(rowsToProcess>0){document.getElementById('run_button').innerHTML+=roundNumtoStr(rowsProcessed,0,!0)+' of '+roundNumtoStr(rowsToProcess,0,!0)+' lines processed'}
document.getElementById('run_button_div').style.width='400px';document.getElementById('run_button').style.width='400px'}
function showProcessCompleted(){document.getElementById('run_button').innerHTML='Run';document.getElementById('run_button_div').style.width='130px';document.getElementById('run_button').style.width='130px'}
async function run(){var outputText='';document.getElementById('output').value='';rowsProcessed=0;rowsToProcess=0;showProcessRunning();await sleep(10);var i=0;updateOutputFieldSpecs();var lines=document.getElementById("input").value.split(/\r?\n/);rowsToProcess=lines.length;var hiddenFields=[];var nonHiddenFields=[];for(i=0;i<outputFieldSpecs.length;i++){if(!outputFieldSpecs[i].hide){nonHiddenFields.push(outputFieldSpecs[i])}else{hiddenFields.push(outputFieldSpecs[i])}}
var startingIndex=0;if(includesHeader('input')){startingIndex=1}
for(i=startingIndex;i<lines.length;i++){if(lines[i]===''){rowsProcessed++;continue}
var j=0;inputFields=lines[i].split(calcDelim('input'));var hiddenOutputFields=[];var outputFields=[];var allInputValues={};for(j=0;j<inputFields.length;j++){allInputValues[j+1]=inputFields[j]}
if(isDoubleQuoted('input')){inputFields[0]=inputFields[0].replace(/^"/,'');var lastIndex=inputFields.length-1;if(lastIndex>0){inputFields[lastIndex]=inputFields[lastIndex].replace(/"$/,'')}}
for(j=0;j<hiddenFields.length;j++){var inputValue;var outputValue;if(hiddenFields[j].input==0){inputValue=hiddenFields[j].fixed_val}else{inputValue=inputFields[hiddenFields[j].input-1]}
inputValue=inputValue||'';outputValue=fieldTransform(inputValue,hiddenFields[j].transform,hiddenFields[j].transform_params,allInputValues);hiddenOutputFields.push(outputValue);allInputValues[-1*(j+1)]=outputValue}
for(j=0;j<nonHiddenFields.length;j++){var inputValue;var outputValue;if(nonHiddenFields[j].input==0){inputValue=nonHiddenFields[j].fixed_val}else if(nonHiddenFields[j].input<0){inputValue=hiddenOutputFields[nonHiddenFields[j].input*-1-1]}else{inputValue=inputFields[nonHiddenFields[j].input-1]}
inputValue=inputValue||'';outputValue=fieldTransform(inputValue,nonHiddenFields[j].transform,nonHiddenFields[j].transform_params,allInputValues);outputFields.push(outputValue)}
var delim=calcDelim('output')||',';var quoted=isDoubleQuoted('output')||!1;var eol=document.getElementById("output_eol").value||'lf';if(i===startingIndex&&includesHeader('output')){var outputFieldNames=[];for(j=0;j<nonHiddenFields.length;j++){outputFieldNames.push(nonHiddenFields[j].name)}
outputText+=assembleOutputLine(outputFieldNames,delim,quoted,eol)}
outputText+=assembleOutputLine(outputFields,delim,quoted,eol);rowsProcessed++;if(rowsProcessed%100===0){showProcessRunning()}
if(rowsProcessed%10===0){await sleep(1)}}
document.getElementById('output').value=outputText;showProcessCompleted()}
function userInput(e){var text='';var bypassValidation=!1;var e=e||event||window.event;var ctrlDown=e.ctrlKey||e.metaKey;if(e.type==='keypress'){var keyCode=e.keyCode||e.which;text=String.fromCharCode(keyCode);if(keyCode==8||keyCode==46||keyCode==37||keyCode==39){bypassValidation=!0}else if(ctrlDown&&(text==='c'||text==='x')){bypassValidation=!0}else if(ctrlDown&&text==='v'){text=(e.clipboardData||window.clipboardData).getData('text')}}else{text=(e.clipboardData||window.clipboardData).getData('text')}
return[text,bypassValidation]}
function onlyAllowDigits(e){var input=userInput(e);var text=input[0];var bypassValidation=input[1];if(bypassValidation){return!0}
if(/[^\d]/gi.test(text)){return!1}}
function onlyAllowDashDigits(e){var input=userInput(e);var text=input[0];var bypassValidation=input[1];if(bypassValidation){return!0}
if(/[^\-\d]/gi.test(text)){return!1}}
function allowTabs(e){if(e.keyCode==9||e.which==9){e.preventDefault();if(this.maxLength>=0&&this.value.length>=this.maxLength){return!1}
var s=this.selectionStart;this.value=this.value.substring(0,this.selectionStart)+"\t"+this.value.substring(this.selectionEnd);this.selectionEnd=s+1}}
generateInputPreviewTable();addOutputField(!1);setCustomDelimDisplay('input');setCustomDelimDisplay('output');var textareas=document.getElementsByTagName('textarea');for(var i=0;i<textareas.length;i++){textareas[i].onkeydown=allowTabs}
document.getElementById('input_delimiter_other').onkeydown=allowTabs;document.getElementById('output_delimiter_other').onkeydown=allowTabs
